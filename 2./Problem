You are working for a retail company that processes large volumes of transaction data daily. To provide personalized discounts to customers, you maintain a list of VIP customers whose discount percentages are periodically updated based on their purchase behavior and engagement. This VIP customer list is relatively small compared to the transaction data and is updated hourly.

You need to ensure that each Spark job processing transaction data for the past hour uses the most up-to-date VIP customer list. Using a broadcast variable for the VIP customer list ensures efficient distribution of this data across the Spark cluster. However, since the VIP customer list changes periodically, you must update the broadcast variable accordingly without causing inconsistency during data processing.
